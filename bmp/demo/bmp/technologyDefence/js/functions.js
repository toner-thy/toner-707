define(function(require,exports){"use strict";var t=require("jquery");var e=require("underscore");exports.is_in_viewport=function(e,r){var o=t(window);var i={top:o.scrollTop(),left:o.scrollLeft()};i.right=i.left+o.width();i.bottom=i.top+o.height();var n=e.offset();n.right=n.left+e.outerWidth();n.bottom=n.top+e.outerHeight();if(r)return i.top<=n.top&&i.bottom>=n.bottom&&i.left<=n.left&&i.right>=n.right;return!(i.right<n.left||i.left>n.right||i.bottom<n.top||i.top>n.bottom)};exports.scroll_to=function(r,o,i,n){var n=n||0;var a=new t.Deferred;var f=o.offset().top-r.offset().top;if(!r.is("body"))f+=r.scrollTop();f=f-n;if(f<0)f=0;i=i||{};i["complete"]=e.wrap(i["complete"],function(t){a.resolve();t&&t()});r.animate({scrollTop:f},i);return a.promise()};exports.fit_parent=function(r,o){var i;var o=o||r.parent();var n=r.parent().children(":visible").not(r);var a=o.innerHeight();var f=e.reduce(n,function(e,r){return e+t(r).outerHeight(true)},0);i=a-f;if(i>0)r.css("height",i);return i};exports.set_label_for=function(r){e.each(r.find("label"),function(r){var o;var i=t(r);var n=i.prev("input");if(!n.length||!n.is(":checkbox, :radio"))return false;o=e.uniqueId("input_");n.attr("id",o);i.attr("for",o)})};exports.copy_clipboard=function(t){if(e.has(window,"clipboardData")){window.clipboardData.setData("Text",t);window.alert(__("copy_to_clipboard")+":\n\n "+t)}else{window.prompt(__("press_ctrl_c_to_copy"),t)}};var r={};exports.delay_till_last=function(t,e,o){if(r[t])window.clearTimeout(r[t]);return r[t]=window.setTimeout(function(){e();delete r[t]},o)};function o(t){var r;for(var i in t){r=t[i];if(!e.isObject(r))continue;if(!e.isArray(r))r=o(r);if(e.isEmpty(r))delete t[i]}return t}exports.clear_empty_object=o});